env:
  contexts:
    - name: juice-shop-context
      urls:
        - https://juice-shop.herokuapp.com
      includePaths:
        - https://juice-shop.herokuapp.com/.*

      authentication:
        method: script
        parameters:
          script: juice-shop-auth

      sessionManagement:
        method: cookie

      users:
        - name: admin-user
          credentials:
            username: admin@juice-sh.op
            password: admin123

# ðŸ“œ REGISTER AUTH SCRIPT (CORRECT SYNTAX)
scripts:
  - name: juice-shop-auth
    type: authentication
    engine: ECMAScript
    script: .github/workflows/zap/scripts/juice-shop-auth.js

jobs:
  - type: spider
    parameters:
      context: juice-shop-context
      user: admin-user
      maxDuration: 5

  - type: activeScan
    parameters:
      context: juice-shop-context
      user: admin-user
      maxScanDurationInMins: 5

  - type: report
    parameters:
      template: traditional-html
      reportDir: .
      reportFile: report_html.html

  - type: report
    parameters:
      template: traditional-json
      reportDir: .
      reportFile: report_json.json

  - type: report
    parameters:
      template: traditional-md
      reportDir: .
      reportFile: report_md.md
